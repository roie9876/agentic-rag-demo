---
mode: agent
---

# Agentic RAG Demo - GitHub Copilot Instructions

## ğŸš¨ **CRITICAL RULE: KEEP MAIN FILE MINIMAL**

You are working with the **Agentic RAG Demo** project. The main file `agentic-rag-demo.py` has grown to 2600+ lines and is becoming unmaintainable. **Your primary directive is to keep new code OUT of the main file.**

## ğŸ“‹ **Core Development Rules**

### Rule 1: **Module-First Development**
- **NEVER** add new functions directly to `agentic-rag-demo.py`
- **ALWAYS** create separate modules for new functionality
- **ONLY** add imports and orchestration calls to the main file

### Rule 2: **Modular Architecture**
When creating new features, use this structure:

```
ğŸ“ NEW CODE LOCATIONS:
â”œâ”€â”€ app/tabs/               # Streamlit tab implementations  
â”œâ”€â”€ core/                   # Core business logic
â”œâ”€â”€ services/               # Business services
â”œâ”€â”€ utils/                  # Utility functions
â”œâ”€â”€ connectors/             # External integrations
â””â”€â”€ components/             # Reusable components
```

### Rule 3: **Existing Module Locations**
The project already has these extracted modules - USE THEM:

```
âœ… ALREADY EXTRACTED:
â”œâ”€â”€ core/azure_clients.py           # Azure service clients
â”œâ”€â”€ core/document_processor.py      # Document processing
â”œâ”€â”€ utils/azure_helpers.py          # Azure utilities  
â”œâ”€â”€ health_check/                   # Health monitoring
â”œâ”€â”€ connectors/sharepoint/          # SharePoint integration
â”œâ”€â”€ test_retrieval.py              # Test retrieval tab âœ…
â”œâ”€â”€ studio2foundry_tab.py           # Studio2Foundry tab âœ…
â”œâ”€â”€ agent_foundry.py                # AI Foundry management
â””â”€â”€ azure_function_helper.py        # Function deployment
```

## ğŸ›  **Implementation Patterns**

### Pattern 1: Adding New Streamlit Tab
```python
# âœ… CORRECT: Create app/tabs/my_new_tab.py
def render_my_new_tab(session_state, clients, **kwargs):
    """Complete tab implementation here."""
    st.header("ğŸ†• My New Feature")
    # All logic here...

# âœ… CORRECT: In agentic-rag-demo.py (minimal)
from app.tabs.my_new_tab import render_my_new_tab

with tab_new:
    render_my_new_tab(
        session_state=st.session_state,
        clients=azure_clients
    )
```

### Pattern 2: Adding New Business Logic
```python
# âœ… CORRECT: Create services/my_service.py
class MyService:
    def __init__(self, config):
        self.config = config
    
    def process_data(self, data):
        # Business logic here...

# âœ… CORRECT: In agentic-rag-demo.py (minimal)
from services.my_service import MyService
service = MyService(config)
```

### Pattern 3: Adding Azure Integration
```python
# âœ… CORRECT: Add to core/azure_clients.py
def init_new_azure_client():
    """Initialize new Azure service."""
    # Implementation here...

# âœ… CORRECT: In agentic-rag-demo.py (minimal)
from core.azure_clients import init_new_azure_client
client = init_new_azure_client()
```

## âŒ **What NOT to Do**

```python
# âŒ WRONG: Adding new functions to agentic-rag-demo.py
def complex_new_feature():
    # 100+ lines of code...
    
def another_helper_function():
    # More code...

# âŒ WRONG: Adding UI logic directly to main file
with st.expander("New Feature"):
    # 50+ lines of Streamlit code...
```

## âœ… **What TO Do**

```python
# âœ… CORRECT: Keep main file minimal with imports only
from app.tabs.complex_feature_tab import render_complex_feature_tab
from services.helper_service import HelperService

# âœ… CORRECT: Simple orchestration only
with tab_feature:
    render_complex_feature_tab(session_state=st.session_state)
```

## ğŸ¯ **Specific Code Guidelines**

### For New Azure Search Features:
- Add to `core/azure_clients.py` or `services/search_service.py`
- NOT to `agentic-rag-demo.py`

### For New UI Components:
- Create `app/components/my_component.py`
- Import and use in main file

### For New Document Processing:
- Extend `core/document_processor.py`
- NOT inline in main file

### For New SharePoint Features:
- Extend `connectors/sharepoint/`
- NOT in main file

### For New Utilities:
- Add to `utils/` directory
- NOT in main file

## ğŸ”„ **When Modifying Existing Code**

1. **If code is already in a module** â†’ Modify the module
2. **If code is in main file and small** â†’ Consider extracting to module
3. **If code is in main file and large** â†’ MUST extract to module

## ğŸ“ **Required Actions for Every New Feature**

1. âœ… **Identify** the appropriate module/directory
2. âœ… **Create** the module file if needed
3. âœ… **Implement** all logic in the module
4. âœ… **Add minimal import** to main file
5. âœ… **Test** the integration
6. âŒ **NEVER** implement directly in main file

## ğŸ¯ **Success Criteria**

- Main file stays under 800 lines (currently 2600+)
- New functionality in appropriate modules
- Clear separation of concerns
- Easy to maintain and test

## ğŸ’¡ **Remember**

**The main file should be an orchestrator, not an implementor.**

When in doubt, ask yourself:
- "Does this belong in the main orchestration file?"
- "Can this be extracted to a focused module?"
- "Will this make the main file harder to maintain?"

If the answer suggests extraction, **create a module first**.

## ğŸš€ **Current Priority**

Help refactor the existing 2600-line main file into clean, modular components while ensuring all new code follows the modular architecture pattern.
